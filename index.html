<!DOCTYPE html>
<html>
  <head>
    <title>Phantom Signer (Offline)</title>
    <script>
      // Minimal inline Base58 encoder fallback
      function encodeBase58(bytes) {
        const alphabet = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';
        let num = BigInt('0x' + [...bytes].map(x => x.toString(16).padStart(2, '0')).join(''));
        let encoded = '';
        while (num > 0) {
          let remainder = num % 58n;
          num = num / 58n;
          encoded = alphabet[Number(remainder)] + encoded;
        }
        for (let byte of bytes) {
          if (byte === 0) {
            encoded = alphabet[0] + encoded;
          } else {
            break;
          }
        }
        return encoded;
      }
    </script>
  </head>
  <body>
    <h2>Sign "Sign-in to Rugcheck.xyz"</h2>
    <button onclick="signMessage()">Sign with Phantom</button>
    <pre id="output">...</pre>
    <script>
      async function signMessage() {
        const provider = window.solana;
        if (!provider?.isPhantom) {
          alert("Phantom wallet not found.");
          return;
        }
        await provider.connect();
        const message = "Sign-in to Rugcheck.xyz";
        const encodedMessage = new TextEncoder().encode(message);
        const signed = await provider.signMessage(encodedMessage, "utf8");

        const output = {
          publicKey: signed.publicKey.toString(),
          signature_base58: encodeBase58(signed.signature),
          signature_bytes: Array.from(signed.signature)
        };

        document.getElementById("output").textContent = JSON.stringify(output, null, 2);
      }
    </script>
  </body>
</html>

